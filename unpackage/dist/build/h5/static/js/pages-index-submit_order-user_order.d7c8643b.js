(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-submit_order-user_order"],{"3d54":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,'.container[data-v-656e681e]{padding-bottom:%?98?%}.tui-box[data-v-656e681e]{padding:%?20?% 0 %?118?%;box-sizing:border-box}.tui-address[data-v-656e681e]{min-height:%?80?%;padding:%?10?% 0;box-sizing:border-box;position:relative}.tui-userinfo[data-v-656e681e]{font-size:%?30?%;font-weight:500;line-height:%?30?%;padding-bottom:%?12?%}.tui-name[data-v-656e681e]{padding-right:%?40?%}.tui-addr[data-v-656e681e]{font-size:%?24?%;word-break:break-all;padding-right:%?25?%}.tui-addr-tag[data-v-656e681e]{padding:%?5?% %?8?%;flex-shrink:0;background:#eb0909;color:#fff;display:inline-flex;align-items:center;justify-content:center;font-size:%?25?%;line-height:%?25?%;-webkit-transform:scale(.8);transform:scale(.8);-webkit-transform-origin:0 center;transform-origin:0 center;border-radius:%?6?%}.tui-bg-img[data-v-656e681e]{position:absolute;width:100%;height:%?8?%;left:0;bottom:0;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAL0AAAAECAMAAADszM6/AAAAOVBMVEUAAAAVqfH/fp//vWH/vWEVqfH/fp8VqfH/fp//vWEVqfH/fp8VqfH/fp//vWH/vWEVqfH/fp//vWHpE7b6AAAAEHRSTlMA6urqqlVVFRUVq6upqVZUDT4vVAAAAEZJREFUKM/t0CcOACAQRFF6r3v/w6IQJGwyDsPT882IQzQE0E3chToByjG5LwMgLZN3TQATmdypCciBya0cgOT3/h//9PgF49kd+6lTSIIAAAAASUVORK5CYII=") repeat}.tui-top[data-v-656e681e]{margin-top:%?20?%;overflow:hidden}.tui-goods-title[data-v-656e681e]{font-size:%?28?%;display:flex;align-items:center}.tui-padding[data-v-656e681e]{box-sizing:border-box}.tui-goods-item[data-v-656e681e]{width:100%;padding:%?20?% %?30?%;box-sizing:border-box;display:flex;justify-content:space-between}.tui-goods-img[data-v-656e681e]{width:%?180?%;height:%?180?%;display:block;flex-shrink:0}.tui-goods-center[data-v-656e681e]{flex:1;padding:%?20?% %?8?%;box-sizing:border-box}.tui-goods-name[data-v-656e681e]{max-width:%?310?%;word-break:break-all;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;font-size:%?26?%;line-height:%?32?%}.tui-goods-attr[data-v-656e681e]{font-size:%?22?%;color:#888;line-height:%?32?%;padding-top:%?20?%;word-break:break-all;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.tui-price-right[data-v-656e681e]{text-align:right;font-size:%?24?%;color:#888;line-height:%?30?%;padding-top:%?20?%}.tui-flex[data-v-656e681e]{width:100%;display:flex;align-items:center;justify-content:space-between;font-size:%?26?%}.tui-total-flex[data-v-656e681e]{justify-content:flex-end}.tui-color-red[data-v-656e681e],\n.tui-invoice-text[data-v-656e681e]{color:#e41f19;padding-right:%?30?%}.tui-balance[data-v-656e681e]{font-size:%?28?%;font-weight:500}.tui-black[data-v-656e681e]{color:#222;line-height:%?30?%}.tui-gray[data-v-656e681e]{color:#888;font-weight:400}.tui-light-dark[data-v-656e681e]{color:#666}.tui-goods-price[data-v-656e681e]{display:flex;align-items:center;padding-top:%?20?%}.tui-size-26[data-v-656e681e]{font-size:%?26?%;line-height:%?26?%}.tui-price-large[data-v-656e681e]{font-size:%?34?%;line-height:%?32?%;font-weight:600}.tui-flex-end[data-v-656e681e]{display:flex;align-items:flex-end;padding-right:0}.tui-phcolor[data-v-656e681e]{color:#b3b3b3;font-size:%?26?%}\n.tui-remark-box[data-v-656e681e]{padding:%?26?% %?30?%}\n.tui-remark[data-v-656e681e]{flex:1;font-size:%?26?%;padding-left:%?64?%}.tui-scale-small[data-v-656e681e]{-webkit-transform:scale(.8);transform:scale(.8);-webkit-transform-origin:100% center;transform-origin:100% center}.tui-scale-small .wx-switch-input[data-v-656e681e]{margin:0!important}\n[data-v-656e681e] uni-switch .uni-switch-input{margin-right:0!important}\n.tui-tabbar[data-v-656e681e]{width:100%;height:%?98?%;background:#fff;position:fixed;left:0;bottom:0;display:flex;align-items:center;justify-content:flex-end;font-size:%?26?%;box-shadow:0 0 1px rgba(0,0,0,.3);padding-bottom:env(safe-area-inset-bottom);z-index:999}.tui-pr-30[data-v-656e681e]{padding-right:%?30?%}.tui-pr-20[data-v-656e681e]{padding-right:%?20?%}.tui-none-addr[data-v-656e681e]{height:%?80?%;padding-left:%?5?%;display:flex;align-items:center}.tui-addr-img[data-v-656e681e]{width:%?36?%;height:%?46?%;display:block;margin-right:%?15?%}.tui-pr25[data-v-656e681e]{padding-right:%?25?%}.tui-safe-area[data-v-656e681e]{height:%?1?%;padding-bottom:env(safe-area-inset-bottom)}',""]),t.exports=e},5565:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"tui-box"},[a("tui-list-cell",{attrs:{arrow:!0,last:!0,radius:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseAddr.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"tui-address"},[t.address.user_name?a("v-uni-view",[a("v-uni-view",{staticClass:"tui-userinfo"},[a("v-uni-text",{staticClass:"tui-name"},[t._v(t._s(t.address.user_name))]),t._v(t._s(t.address.tel_number))],1),a("v-uni-view",{staticClass:"tui-addr"},["1"==t.address.check?a("v-uni-view",{staticClass:"tui-addr-tag"},[t._v("默认")]):t._e(),a("v-uni-view",{staticClass:"tui-addr-tag"},[t._v(t._s(t.address.tag))]),a("v-uni-text",[t._v(t._s(t.address.detail_info))])],1)],1):a("v-uni-view",{staticClass:"tui-none-addr"},[a("v-uni-image",{staticClass:"tui-addr-img",attrs:{src:i("11ca"),mode:"widthFix"}}),"2"==t.type?a("v-uni-text",[t._v("选择发货地址")]):a("v-uni-text",[t._v("选择收货地址")])],1)],1),a("v-uni-view",{staticClass:"tui-bg-img"})],1),a("v-uni-view",{staticClass:"tui-top tui-goods-info"},[a("tui-list-cell",{attrs:{hover:!1,lineLeft:!1}},[a("v-uni-view",{staticClass:"box full-width"},[a("v-uni-view",{staticClass:"tui-goods-title"},[t._v("商品信息")]),a("v-uni-view",[t.order_no?t._e():a("v-uni-button",{staticClass:"btn-info btn-sm",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onAddProduct.apply(void 0,arguments)}}},[t._v("添加")])],1)],1)],1),t._l(t.list,(function(e,i){return a("v-uni-view",{key:i,staticClass:"pp"},[a("v-uni-view",{staticClass:"rows"},[a("v-uni-input",{attrs:{type:"text",placeholder:"产品",value:e.product_name,"data-key":"product_name","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}}),a("v-uni-input",{attrs:{type:"text",placeholder:"规格",value:e.spec_name,"data-key":"spec_name","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}}),a("v-uni-input",{attrs:{type:"text",placeholder:"型号",value:e.type_name,"data-key":"type_name","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"rows"},[a("v-uni-input",{attrs:{type:"digit",placeholder:"单价",value:e.price,"data-key":"price","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}}),a("v-uni-input",{attrs:{type:"digit",placeholder:"数量",value:e.product_count,"data-key":"product_count","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}}),a("v-uni-input",{attrs:{type:"text",placeholder:"金额",value:t.itemSumPrice(e.product_count,e.price),"data-key":"total","data-index":i,disabled:"true"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"rows"},[a("v-uni-input",{attrs:{type:"text",placeholder:"单位",value:e.company_name,"data-key":"company_name","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}}),a("v-uni-input",{attrs:{type:"text",placeholder:"备注",value:e.product_remark,"data-key":"product_remark","data-index":i},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputOrder.apply(void 0,arguments)}}}),t.order_no?t._e():a("v-uni-view",{staticClass:"btn-danger text-center-hv",staticStyle:{width:"100rpx",padding:"2rpx"},attrs:{"data-index":i},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onDelItem.apply(void 0,arguments)}}},[t._v("删除")])],1)],1)})),a("tui-list-cell",{attrs:{hover:!1}},[a("v-uni-view",{staticClass:"tui-padding tui-flex"},[a("v-uni-view",[t._v("商品总额")]),a("v-uni-view",[t._v("￥"+t._s(t.sumPrice()))])],1)],1),a("tui-list-cell",{attrs:{hover:!1,lineLeft:!1,padding:"0"}},[a("v-uni-view",{staticClass:"tui-remark-box tui-padding tui-flex"},[a("v-uni-view",[t._v("订单备注")]),a("v-uni-input",{staticClass:"tui-remark",attrs:{"data-key":"order_remark",type:"text",placeholder:"选填: 请先和商家协商一致","placeholder-class":"tui-phcolor"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onInputAddress.apply(void 0,arguments)}}})],1)],1),a("tui-list-cell",{attrs:{hover:!1,last:!0}},[a("v-uni-view",{staticClass:"tui-padding tui-flex tui-total-flex"},[a("v-uni-view",{staticClass:"tui-flex-end tui-color-red"},[a("v-uni-view",{},[t._v("合计：")]),a("v-uni-view",{staticClass:"tui-size-26"},[t._v("￥")]),a("v-uni-view",{staticClass:"tui-price-large"},[t._v(t._s(t.sumPrice()))])],1)],1)],1)],2)],1),a("v-uni-view",{staticClass:"tui-safe-area"}),a("v-uni-view",{staticClass:"tui-tabbar"},[a("v-uni-view",{staticClass:"tui-flex-end tui-color-red tui-pr-20"},[a("v-uni-view",{},[t._v("实付金额:")]),a("v-uni-view",{staticClass:"tui-size-26"},[t._v("￥")]),a("v-uni-view",{staticClass:"tui-price-large"},[t._v(t._s(t.sumPrice()))])],1),"1"==t.sum.state?a("v-uni-view",{staticClass:"tui-pr25 rows"},[a("tui-button",{attrs:{width:"200rpx",height:"70rpx",type:"danger",shape:"circle"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.btnAliPay.apply(void 0,arguments)}}},[t._v("支付宝支付")]),a("tui-button",{attrs:{width:"200rpx",height:"70rpx",type:"danger",shape:"circle"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.btnWxPay.apply(void 0,arguments)}}},[t._v("微信支付")])],1):a("v-uni-view",{staticClass:"tui-pr25"},[a("tui-button",{attrs:{width:"200rpx",height:"70rpx",type:"danger",shape:"circle"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.btnCreateOrder.apply(void 0,arguments)}}},[t._v("确定订单")])],1)],1)],1)},n=[]},7087:function(t,e,i){"use strict";i.r(e);var a=i("caef"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},7729:function(t,e,i){"use strict";i.r(e);var a=i("5565"),n=i("7087");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("d11e");var r=i("f0c5"),d=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"656e681e",null,!1,a["a"],void 0);e["default"]=d.exports},caef:function(t,e,i){"use strict";i("7a82");var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("14d9"),i("a434");var n=a(i("5530")),s=a(i("8c17")),r=a(i("9b78")),d=a(i("1206")),o={components:{tuiButton:s.default,tuiListCell:r.default,tuiBottomPopup:d.default},data:function(){return{app:this.app,list:[],sum:{},order:{},order_no:"",product_id:"",product_spec_id:"",product_count:1,user_id:"",address:{},hasCoupon:!0,insufficient:!1}},computed:{itemSumPrice:function(){return function(t,e){return t*e}},sumPrice:function(){return function(){if(this.sum&&this.sum.sum_price&&this.sum.sum_price>0)return this.sum.sum_price;var t=0;for(var e in this.list){var i=this.list[e];t+=i.product_count*i.price}return t}}},methods:{onInputAddress:function(t){var e=this.app.ed(t).key;this.address[e]=this.app.ev(t)},onInputOrder:function(t){var e=this.app.ed(t).key,i=this.app.ed(t).index;this.list[i][e]=this.app.ev(t)},chooseAddr:function(){uni.navigateTo({url:"../address/address"})},btnWxPay:function(){var t=this;t.payPre((function(){t.app.msg("","敬告：您正在使用微信支付订单交易，当此订单交易完后系统将扣除此订单总金额的0.7%交易服务费，然后把剩余的货款转入对方的已绑定的微信里，请您告知对方，同时告知对方如果未绑定微信和输入保存真实姓名(真实姓名必须与微信实名认证相同)将无法收到货款。",(function(e){e&&t.app.wxPay({total:t.order.sum_price,subject:"自定义订单",out_trade_no:t.order.order_no},(function(e){t.payFinish({pay_type:2})}))}))}))},btnAliPay:function(){var t=this;t.payPre((function(){t.app.msg("","敬告：您正在使用支付宝支付订单交易，当此订单交易完后系统将扣除此订单总金额的0.7%交易服务费，然后把剩余的货款转入对方的已绑定的支付宝里，请您告知对方，同时告知对方如果未绑定支付宝和输入保存真实姓名(真实姓名必须与支付宝实名认证相同)将无法收到货款。",(function(e){e&&t.app.aliPay({total:t.order.sum_price,subject:"自定义订单",out_trade_no:t.order.order_no},(function(e){t.payFinish({pay_type:1})}))}))}))},payPre:function(t){var e=this;this.address.user_name?this.order_no?t&&t():this.app.post("api/order/cre_order_user_id?XDEBUG_SESSION_START=11841",{user_id:this.user_id,json:this.app.toJson(this.list),address:this.app.toJson(this.address),type:this.type},(function(i){e.list=i.list,e.sum=i.sum,e.order_no=i.order_no,e.address=i.address,t&&t()})):this.app.toast("请选择收获地址")},payFinish:function(t){var e=this;e.app.post("api/order/pay_finish",(0,n.default)({order_no:e.order.order_no,is_clean:"0"},t),(function(t){e.app.toast("支付成功"),e.app.go("./pay_finish",{order_no:t.order_no})}))},onAddProduct:function(){this.list.push({product_name:"",spec_name:"",type_name:"",product_count:"",price:"",total:"",company_name:"",product_remark:"",type:""})},btnCreateOrder:function(t){var e=this;if(this.address.user_name){for(var i in this.list){var a=this.list[i];if(!a.product_name)return void this.app.toast("请输入产品名称");if(!a.spec_name)return void this.app.toast("请输入规格名称");if(!a.type_name)return void this.app.toast("请输入型号名称");if(!a.price)return void this.app.toast("请输入单价");if(!a.product_count)return void this.app.toast("请输入数量");if(!a.company_name)return void this.app.toast("请输入单位")}this.order_no?"1"==this.sum.state&&this.pay():this.app.post("api/order/cre_order_user_id?XDEBUG_SESSION_START=11841",{user_id:this.user_id,json:this.app.toJson(this.list),address:this.app.toJson(this.address),type:this.type},(function(t){e.list=t.list,e.sum=t.sum,e.order_no=t.order_no,e.address=t.address,e.app.toast("生成订单"),e.app.go("./order_finish",{order_no:t.order_no})}))}else this.app.toast("请选择收获地址")},onDelItem:function(t){var e=this.app.ed(t).index;this.list.splice(e,1)}},onLoad:function(t){t.order_no&&(this.order_no=t.order_no),t.product_spec_id&&(this.product_spec_id=t.product_spec_id),t.product_id&&(this.product_id=t.product_id),t.product_count&&(this.product_count=t.product_count),t.user_id&&(this.user_id=t.user_id),t.type&&(this.type=t.type)},onShow:function(){var t=this;this.user_id&&this.app.post("api/user/is_friend?XDEBUG_SESSION_START=14470",{user_id:this.user_id},(function(e){"0"==e.code||t.app.msgSys("成为合作商之后才能下单",(function(e){t.app.back()}))})),this.order_no?this.app.post("api/order/find_order",{order_no:this.order_no},(function(e){t.list=e.list,t.sum=e.sum,t.order=e.sum,e.address&&(t.address=e.address)})):this.product_spec_id?this.app.post("api/order/pre_order_float",{product_spec_id:this.product_spec_id,product_count:this.product_count},(function(e){t.list=e.list,t.sum=e.sum,e.address&&(t.address=e.address)})):this.product_id?this.app.post("api/order/pre_order_float",{product_id:this.product_id,product_count:this.product_count},(function(e){t.list=e.list,t.sum=e.sum,e.address&&(t.address=e.address)})):this.user_id?this.app.post("api/order/pre_order_user_id",{user_id:this.user_id},(function(e){t.list=e.list,0==t.list.length&&t.onAddProduct(),t.sum=e.sum,t.order=e.sum,e.address&&(t.address=e.address)})):this.app.post("api/order/pre_order",{},(function(e){t.list=e.list,t.sum=e.sum,e.address&&(t.address=e.address)}))}};e.default=o},cff7:function(t,e,i){var a=i("3d54");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("1f80e898",a,!0,{sourceMap:!1,shadowMode:!1})},d11e:function(t,e,i){"use strict";var a=i("cff7"),n=i.n(a);n.a}}]);